const fs = require('fs');

// 파일 읽기 (현재 인코딩으로)
const content = fs.readFileSync('src/admin.js', 'utf8');

// 깨진 한글 패턴을 올바른 한글로 교체
const fixes = {
  '?생관리시?템': '인생관리시스템',
  '?용???인 관?': '사용자 승인 관리',
  '??메인?로 ?아가?': '메인으로 돌아가기',
  '???': '승인 대기',
  '?인???용??': '승인된 사용자',
  '?체 ?용??': '전체 사용자',
  '?신???': '재신청 대기',
  '취소 ???신? ?용??': '취소 후 재신청한 사용자',
  '?인 ??': '승인 대기',
  '챌린지 참???': '챌린지 참가자',
  '?인 ??중인 ?용??': '승인 대기중인 사용자',
  '마???데?트': '마지막 업데이트',
  '?로고침': '새로고침',
  '?택 ?인': '선택 승인',
  '?택 취소': '선택 취소',
  '???인???용??': '승인된 사용자',
  '?괄 기한 ?정': '일괄 기한 설정',
  '챌린지 참???추?': '챌린지 참가자 추가',
  '? 챌린지 참???': '챌린지 참가자',
  '?괄 ?외': '일괄 제외',
  '?신???': '재신청 대기',
  '?내:': '안내:',
  '취소???용?? ?시 ?청??경우?니?? ?인?거???시 취소?????습?다.': '취소된 사용자가 다시 신청한 경우입니다. 승인하거나 거절 시 다시 취소됩니다.',
  '?로?을 찾을 ???습?다': '프로필을 찾을 수 없습니다',
  '?용???로?을 불러?????습?다.': '사용자 프로필을 불러올 수 없습니다.',
  '관리자 권한???요?니??': '관리자 권한이 필요합니다',
  '???이지??관리자??근?????습?다.': '이 페이지는 관리자만 접근할 수 있습니다.',
  '?재 ?태': '현재 상태',
  '??': '역할',
  '로그?이 ?요?니??': '로그인이 필요합니다',
  '관리자 ?이지???근?려?로그?해주세??': '관리자 페이지에 접근하려면 로그인해주세요.',
  '로그?하??가?': '로그인하러 가기',
  'Supabase 초기???류': 'Supabase 초기화 오류',
  'Supabase ?라?언?? 초기?할 ???습?다.': 'Supabase 클라이언트를 초기화할 수 없습니다.',
  '?경 변???류': '환경 변수 오류',
  'config.js ?일??Supabase URL?Anon Key??정?주?요.': 'config.js 파일에 Supabase URL과 Anon Key를 설정해주세요.',
  '?션 ?류': '세션 오류',
  '?류가 발생?습?다': '오류가 발생했습니다',
  '?세 ?보': '상세 정보',
  '?용??목록 로드': '사용자 목록 로드',
  '관리자 권한???습?다. ?시 로그?????도?세??': '관리자 권한이 없습니다. 다시 로그인해주세요.',
  '?용??목록??불러?????습?다:': '사용자 목록을 불러올 수 없습니다:',
  '?정 ?메??검??(?버깅용)': '특정 이메일 검색(디버깅용)',
  '?체 ?용?????': '전체 사용자 저장',
  '모든 ?태???용??로그': '모든 상태별 사용자 로그',
  '??태??용???메??로그': '상태별 사용자 이메일 로그',
  '?택 목록?서 존재?? ?는 ID ?거': '선택 목록에서 존재하지 않는 ID 제거',
  '?더??': '렌더링',
  '?체 ?용???는 ???+ ?인???용?만 계산 (취소???용?는 ??????외)': '전체 사용자는 대기+승인된 사용자만 계산 (취소된 사용자는 제외)',
  '?계 카드': '통계 카드',
  '?인 ??목록': '승인 대기 목록',
  '?인???용??목록': '승인된 사용자 목록',
  '챌린지 참???목록': '챌린지 참가자 목록',
  '?신???목록 (rejected ?태)': '재신청 대기 목록 (rejected 상태)',
  'Lucide ?이??더??': 'Lucide 아이콘 렌더링',
  '?인???용???계 로드': '승인된 사용자 통계 로드',
  '챌린지 참????계 로드 (챌린지 ?? ?성?된 경우)': '챌린지 참가자 통계 로드 (챌린지 탭이 생성된 경우)',
  '?용???이??더??': '사용자 테이블 렌더링',
  '?인 ??중인 ?용?? ?습?다. ?': '승인 대기중인 사용자가 없습니다.',
  '챌린지 참??? ?습?다.': '챌린지 참가자가 없습니다.',
  '?인???용?? ?습?다.': '승인된 사용자가 없습니다.',
  '?로??': '프로필',
  '?름': '이름',
  '?메??': '이메일',
  '?번??용?황': '이번 주 사용 현황',
  '?청?시': '신청 시각',
  '?용 기한': '사용 기한',
  '?업': '작업',
  '만료??': '만료됨',
  '무제??': '무제한',
  '?정': '설정',
  '?인': '승인',
  '취소': '취소',
  '??': '거절',
  '챌린지?서 ?외': '챌린지에서 제외',
  '?기로 변?': '대기로 변경',
  '???환': '탭 전환',
  '모든 ?션 ?기?': '모든 섹션 숨기기',
  '?택???? ?션??시': '선택한 탭의 섹션 표시',
  '?성 ???시': '활성 탭 표시',
  '?쒖꽦 ???쒖떆': '생성 즉시 표시',
  '챌린지 참????? ?? ???계 로드': '챌린지 참가자 탭 선택 시 통계 로드',
  '?용???태 ?데?트': '사용자 상태 업데이트',
  '\'취소\' 버튼 ?릭 ??profiles?서 ?전 ??': '\'취소\' 버튼 클릭 시 profiles에서 완전 삭제',
  '?말????용?? ???시겠습?까? ?시 ?청?면 ?로 ?성?니??': '정말로 이 사용자를 삭제하시겠습니까? 다시 신청하면 새로 생성됩니다.',
  '?? ?에 ?용???보 ?인 (?버깅용)': '삭제 전에 사용자 정보 확인 (디버깅용)',
  '?용?? 찾을 ???습?다:': '사용자를 찾을 수 없습니다:',
  'DELETE ?행 (.select() ?거 - ?? ??조회??RLS 문제 발생 가??': 'DELETE 실행 (.select() 제거 - 삭제 후 조회 시 RLS 문제 발생 가능)',
  'RLS ?책 ?인 ?내': 'RLS 정책 확인 내용',
  '?? ?패:': '삭제 실패:',
  'RLS ?책 문제?????습?다. Supabase SQL Editor?서 ?음 ?책???인?주?요:': 'RLS 정책 문제일 수 있습니다. Supabase SQL Editor에서 다음 정책을 확인해주세요:',
  '?? ?인???해 ?조??(?택??)': '삭제 확인을 위해 재조회(선택사항)',
  '??가 ?료?? ?았?????습?다. ?로고침 ???인?주?요.': '삭제가 완료되지 않았을 수 있습니다. 새로고침 후 확인해주세요.',
  '목록 즉시 ?로고침': '목록 즉시 새로고침',
  '?용?? ???었?니??': '사용자가 삭제되었습니다.',
  '????외가 발생?습?다:': '삭제 중 예외가 발생했습니다:',
  '?인/차단? 기존 로직 ??': '승인/차단 등 기존 로직 계속',
  '?인': '승인',
  '차단': '차단',
  '?말????용?의 ?태?"${statusText}"?로 변경하?겠?니?': '정말로 이 사용자의 상태를 "${statusText}"로 변경하시겠습니까?',
  '?태가 변경되?습?다.': '상태가 변경되었습니다.',
  '?택??${ids.length}명을 ???시겠습?까? ?시 ?청?면 ?로 ?성?니??': '선택한 ${ids.length}명을 삭제하시겠습니까? 다시 신청하면 새로 생성됩니다.',
  '?택??${ids.length}명을 "${statusText}" 처리?시겠습?까?': '선택한 ${ids.length}명을 "${statusText}" 처리하시겠습니까?',
  '?택??${ids.length}??태가 변경되?습?다.': '선택한 ${ids.length}명의 상태가 변경되었습니다.',
  '?택 ?태 반영 ?해 ?렌??': '선택 상태 반영 위해 렌더링',
  '?인???용??체크박스': '승인된 사용자 체크박스',
  '챌린지 참???추? 버튼': '챌린지 참가자 추가 버튼',
  '챌린지 참???체크박스': '챌린지 참가자 체크박스',
  '?로고침': '새로고침',
  '로그?이 만료?었?니?? ?시 로그?해주세??': '로그인이 만료되었습니다. 다시 로그인해주세요.',
  '관리자 권한???습?다. 메인?로 ?동?니??': '관리자 권한이 없습니다. 메인으로 이동합니다.',
  '?로고침 ?..': '새로고침 중...',
  '?공 메시지 (?택??)': '성공 메시지 (선택사항)',
  '목록??갱신?었?니??': '목록이 갱신되었습니다.',
  '목록???로고침?는 ??류가 발생?습?다:': '목록을 새로고침하는 중 오류가 발생했습니다:',
  '로그?웃': '로그아웃',
  '만료???정 모달 ?기': '만료일 설정 모달 열기',
  '?용 기한 ?정': '사용 기한 설정',
  '무제??': '무제한',
  '?정 ?짜까?': '지정 날짜까지',
  '???': '저장',
  '만료??????': '만료일 토글 함수',
  '만료????': '만료일 저장',
  '?류가 발생?습?다:': '오류가 발생했습니다:',
  '?키?캐시 ?러??경우 ?세 ?내': '스키마 캐시 오류인 경우 상세 안내',
  '?️ expires_at 컬럼??찾을 ???습?다.': '⚠️ expires_at 컬럼을 찾을 수 없습니다.',
  '? ?결 방법:': '해결 방법:',
  '1️⃣ SQL ?행 ?인:': '1️⃣ SQL 실행 확인:',
  '   - Supabase SQL Editor?서': '   - Supabase SQL Editor에서',
  '   - supabase/force_add_expires_at.sql ?일 ?행': '   - supabase/force_add_expires_at.sql 파일 실행',
  '   - ?는 SUPABASE_EXPIRES_AT_SETUP.md 참고': '   - 또는 SUPABASE_EXPIRES_AT_SETUP.md 참고',
  '2️⃣ 컬럼 ?인:': '2️⃣ 컬럼 확인:',
  '   - Table Editor ??profiles ?이?': '   - Table Editor에서 profiles 테이블',
  '   - expires_at 컬럼 존재 ?? ?인': '   - expires_at 컬럼 존재 여부 확인',
  '3️⃣ ?로?트 ?시??': '3️⃣ 프로젝트 재시작:',
  '   - Settings ??General ??"Restart Project"': '   - Settings → General → "Restart Project"',
  '   - ?시???료 ??1-2???': '   - 재시작 완료 후 1-2분 대기',
  '4️⃣ 브라?? ?로고침:': '4️⃣ 브라우저 새로고침:',
  '   - Ctrl+Shift+R (강력 ?로고침)': '   - Ctrl+Shift+R (강력 새로고침)',
  '?용 기한???정?었?니??': '사용 기한이 설정되었습니다.',
  '?괄 기한 ?정 모달 ?기': '일괄 기한 설정 모달 열기',
  '?용?? ?택?주?요.': '사용자를 선택해주세요.',
  '?괄 ?용 기한 ?정': '일괄 사용 기한 설정',
  '?택???용??': '선택한 사용자:',
  '?괄 기한 ????': '일괄 기한 토글 함수',
  '?괄 기한 ???': '일괄 기한 저장',
  '?짜??택?주?요.': '날짜를 선택해주세요.',
  '?택??${selectedIds.length}명의 ?용 기한??${dateText}?로 ?정?시겠습?까?': '선택한 ${selectedIds.length}명의 사용 기한을 ${dateText}로 설정하시겠습니까?',
  '?택??${selectedIds.length}명의 ?용 기한???정?었?니??': '선택한 ${selectedIds.length}명의 사용 기한이 설정되었습니다.',
  '?용?별 주간 ?계 조회 ?수': '사용자별 주간 통계 조회 함수',
  '?러 ?용?의 ?계?병렬?로드': '여러 사용자의 통계를 병렬로 로드',
  '?계 조회 (병렬 처리)': '통계 조회 (병렬 처리)',
  '캐시 ?인': '캐시 확인',
  '媛??ъ슜?먯쓽 ?꾩〈 ?ъ슜 (?놁쑝?湲곕낯媛?Asia/Seoul)': '각 사용자의 타임존 사용 (없으면 기본값 Asia/Seoul)',
  '??용?의 ?계??DOM???데?트': '각 사용자의 통계를 DOM에 업데이트',
  '?': '루틴',
  '??': '할일',
  '?': '성찰',
  '챌린지 참???추?': '챌린지 참가자 추가',
  '?택??${userIds.length}명을 챌린지 참??로 추??시겠습?까?': '선택한 ${userIds.length}명을 챌린지 참가자로 추가하시겠습니까?',
  '챌린지 참???추? ?패:': '챌린지 참가자 추가 실패:',
  '?택??${userIds.length}명이 챌린지 참??로 추??었?니??': '선택한 ${userIds.length}명이 챌린지 참가자로 추가되었습니다.',
  '챌린지 참???추? ??외가 발생?습?다:': '챌린지 참가자 추가 중 예외가 발생했습니다:',
  '챌린지?서 ?외 (개별)': '챌린지에서 제외 (개별)',
  '???용?? 챌린지?서 ?외?시겠습?까?': '이 사용자를 챌린지에서 제외하시겠습니까?',
  '챌린지?서 ?외 ?패:': '챌린지에서 제외 실패:',
  '챌린지?서 ?외?었?니??': '챌린지에서 제외되었습니다.',
  '챌린지?서 ?외 ??외가 발생?습?다:': '챌린지에서 제외 중 예외가 발생했습니다:',
  '챌린지?서 ?괄 ?외': '챌린지에서 일괄 제외',
  '?택??${userIds.length}명을 챌린지?서 ?외?시겠습?까?': '선택한 ${userIds.length}명을 챌린지에서 제외하시겠습니까?',
  '?택??${userIds.length}명이 챌린지?서 ?외?었?니??': '선택한 ${userIds.length}명이 챌린지에서 제외되었습니다.',
  '챌린지?서 ?외 ??외가 발생?습?다:': '챌린지에서 제외 중 예외가 발생했습니다:',
  '초기???행': '초기화 실행',
  '?더 ???벤??바인?을 ?해 MutationObserver ?체로 ?더 ???서 ?출': '렌더링 후 이벤트 바인딩을 위해 MutationObserver 체계로 렌더링 완료 후 호출',
  'pending ?션 체크박스 ?바?딩': 'pending 섹션 체크박스 바인딩'
};

let fixedContent = content;
for (const [broken, fixed] of Object.entries(fixes)) {
  fixedContent = fixedContent.replace(new RegExp(broken.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), fixed);
}

// UTF-8로 저장
fs.writeFileSync('src/admin.js', fixedContent, 'utf8');
console.log('Fixed encoding issues in src/admin.js');





