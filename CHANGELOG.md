# 변경 이력 (Changelog)

## v1.2 (2025-01-31) ✅
**안정 버전 릴리즈 - 사용자 편의성 및 AI 기능 개선**

### 관리자 페이지 개선
- ✅ **기한 만료 탭 추가 (2025-01-30)**
  - 문제: 기한 만료된 사용자를 별도로 관리하기 어려움
  - 해결: "기한 만료" 탭 추가하여 `expires_at < current_date` 사용자 자동 필터링
  - 구현:
    - 네 번째 탭으로 "기한 만료 (N명)" 추가 (빨간색 테마)
    - 통계 카드: 기한 만료 사용자 수 표시
    - 개별 기한 연장: 각 행의 "기한 연장" 버튼
    - 일괄 기한 연장: 여러 사용자 선택 후 일괄 처리 (무제한 또는 특정 날짜)
    - 전체 선택/해제 체크박스 지원
  - 효과: 기한 만료 사용자를 쉽게 찾아 기한 연장 가능

### 월간 데일리 루틴 개선
- ✅ **전월 루틴 자동 복사 기능 (2025-01-30)**
  - 문제: 매월 초에 루틴을 수동으로 재입력해야 하는 불편함
  - 해결: "전월 루틴 복사" 버튼으로 전월 루틴을 현재 월에 자동 복사
  - 구현:
    - 월간 데일리 루틴 보기 모드에 "전월 루틴 복사" 버튼 추가 (수정하기 버튼 왼쪽)
    - `fetchPreviousMonthRoutines()`: 전월 루틴 조회 함수
    - `copyPreviousMonthRoutines()`: 전월 루틴 복사 함수
      - 전월 루틴 없으면 알림 표시
      - 전월 루틴 있으면 복사 확인 메시지 (전월/현재월 이름, 루틴 개수 표시)
      - 이번 달 루틴 있으면 덮어쓰기 확인 메시지
      - 복사 시 `monthly_plans` 테이블에 저장 (기존 `content_md`, `linked_year` 유지)
      - `syncMonthlyRoutines()` 호출하여 `routines` 테이블 동기화
      - 오늘 날짜 기준 `active_from_date` 설정 (오늘부터 적용)
      - 과거 루틴은 Soft Delete로 보존 (히스토리 관리)
    - `updateCopyButtonVisibility()`: 버튼 표시/숨김 제어 (개발 모드: 항상 표시)
    - 버튼 스타일: btn-secondary (기존 디자인과 조화)
    - 아이콘: `copy` (Lucide)
  - 효과: 
    - 매월 루틴 재입력 불필요, 전월 루틴 자동 복사로 편의성 향상
    - 월별 루틴 히스토리 자동 관리 (어느 달에 어떤 루틴이 있었는지 추적 가능)
    - 과거 루틴 체크 기록 보존 (Soft Delete)
  - 주의사항:
    - `isRoutineDue()` 함수가 `schedule.month`로 월별 루틴을 엄격히 구분하므로 충돌 없음
    - `active_from_date`와 `deleted_at`로 월 중 루틴 변경 이력 정확히 추적
    - 복사된 루틴은 오늘부터 적용되며, 과거 날짜의 루틴은 변경되지 않음

- ✅ **편집 모드 UX 개선 (2025-02-01)**
  - 문제: 루틴이 비어있을 때 "수정하기" 버튼을 누르면 빈 입력 필드가 자동으로 생성되어 혼란스러움
  - 해결: 편집 모드에서 빈 입력 필드 자동 생성 제거, 사용자가 "+ 루틴 추가" 버튼으로 명시적으로 추가하도록 개선
  - 구현:
    - `renderRoutineInputs()` 함수: `routines.length === 0`일 때 자동으로 `addRoutineInput()`을 호출하던 로직 제거
    - `handleCancelEdit()` 함수: 루틴 유무와 관계없이 항상 `displayRoutines()`만 호출하도록 간소화
    - "취소" 버튼 클릭 시 빈 상태 메시지("등록된 루틴이 없습니다") 표시, 빈 입력 필드 표시하지 않음
    - "수정하기" 버튼 클릭 시 빈 입력 필드 표시하지 않고, "+ 모닝루틴 추가" / "+ 나이트루틴 추가" 버튼으로만 추가 가능
  - 효과:
    - 사용자 의도가 명확해짐 (루틴 추가는 사용자가 명시적으로 버튼 클릭)
    - 빈 상태와 편집 모드의 구분이 명확해짐
    - 불필요한 빈 입력 필드가 자동으로 생성되지 않아 깔끔한 UX 제공

### AI 기능 개선
- ✅ **AI 레이트리밋 제한 제거 (2025-01-30)**
  - 문제: AI 기능 사용 시 주/월/연 2회 제한으로 인한 불편함
  - 해결: 모든 AI 기능의 레이트리밋 제한 제거 (언제든지 사용 가능)
  - 구현:
    - Edge Function에서 레이트리밋 체크 로직 제거 (429 에러 반환 제거)
    - 사용량 카운터는 계속 증가하여 통계 추적 유지 (`ai_usage_counters` 테이블)
    - 프론트엔드에서 레이트리밋 관련 팝업 메시지 제거
    - 적용 기능: 주간/월간/연간 AI 성찰, AI 연간 목표 피드백, AI 월실천계획 제안
  - 효과: 사용자가 언제든지 AI 피드백을 받을 수 있어 사용성 향상
  - 주의: 사용량은 계속 추적되므로 관리자가 통계 확인 가능

- ✅ **AI 월실천계획 제안 가독성 개선 (2025-12-31)**
  - 문제: 연간목표와 월실천계획에서 목표들이 붙어있어 가독성이 떨어짐
  - 해결: 목표 사이에 빈 줄 추가하여 가독성 향상
  - 구현:
    - **월실천계획 AI 프롬프트 v8** (Edge Function):
      - 출력 형식 개선: 각 목표 사이에 `\n\n` 추가
      - 화살표(→) 앞에 줄바꿈 추가하여 목표와 행동 시각적 분리
      - 형식: `1. [목표]\n→ [행동]\n\n2. [목표]\n→ [행동]`
      - 프롬프트 버전: `monthly_plan_v8`
    - **연간목표 표시 개선** (프론트엔드):
      - `formatYearlyGoalText()` 함수 추가: `\n(\d+\.)` → `\n\n$1` 변환
      - 월간 실천계획 섹션의 연간목표 컬럼에 적용 (보기 모드 + 편집 모드)
      - 파일: `src/pages/goals.js`
  - 효과:
    - 목표들이 시각적으로 명확히 구분되어 가독성 대폭 향상
    - 긴 목표 텍스트도 읽기 편해짐
    - 사용자 경험 개선

### 버그 수정
- ✅ **날짜 선택 시 페이지 재렌더링 버그 수정**
  - 문제: 날짜 변경 시 오늘 날짜 데이터만 계속 표시되는 현상
  - 원인: 라우터 상태 체크에서 selectedDate 미포함, currentHash 비교 오류
  - 해결: `currentState`에 selectedDate 추가, `rerender()` 시 `lastRenderedState = null`, `hashPath` 변수로 정확한 경로 비교
  - 구현: `src/router.js`의 `handleRoute` 함수에서 라우터 상태 관리 개선

### 리포트 개선
- ✅ **주간/월간/연간 실행률 기준 개선**
  - **현재 주**: 월요일 ~ 오늘까지를 기준으로 실행률 계산 (과거 주는 전체 주 기준)
  - **현재 달**: 1일 ~ 오늘까지를 기준으로 실행률 계산 (과거 달은 전체 달 기준)
  - **현재 연도**: 1월 1일 ~ 오늘까지를 기준으로 실행률 계산 (과거 연도는 전체 연도 기준)
  - 효과: 초반 기간(주/달/연도 시작 직후)에 실행률이 비정상적으로 낮게 표시되는 문제 해결
  - 구현:
    - 주간: `src/utils/weeklyStats.js`의 `getWeeklyStats` 함수에서 `effectiveEndDate` 계산
    - 월간: `src/utils/monthlyStats.js`의 `getMonthlyStats` 함수에서 `effectiveEndDate` 계산
    - 연간: `src/utils/yearlyStats.js`의 `getYearlyStats` 함수에서 `effectiveEndDate` 계산

---

## v1.1 (2025-01-28) ✅
**안정 버전 릴리즈 - 핵심 기능 구현 완료**

### 인증 및 세션 관리
- ✅ 로그인 화면 (로고 이미지, 구글 로그인 버튼, 반응형 디자인)
- ✅ 세션 관리 및 로그인 성능 최적화 (초기 로딩 속도 2-3배 향상)
- ✅ 토큰 갱신 시 페이지 재렌더링 방지
- ✅ 탭 전환 시 불필요한 새로고침 방지 (상태 기반 렌더링 스킵)

### 오늘 관리 (Do)
- ✅ 날짜 선택 바 (이전/다음 날짜 이동, 달력 오버레이, 오늘로 이동 버튼)
- ✅ 오늘 할일 (카테고리 탭, Enter 키 수정 저장, 수동 순서 변경, 날짜 이동 기능)
- ✅ 오늘 루틴 (모닝/나이트 구분, 진행률 표시, 날짜 기준 필터링)
- ✅ 하루 성찰 (4항목, 기본 접힘 상태, 저장 후 자동 접힘)
- ✅ Carry-over 모달 (미완료 이월, 포기 처리)

### 계획 관리 (Plan)
- ✅ 월간 데일리 루틴 (모닝/나이트 0~10개 입력)
- ✅ 연간 목표 (3영역, 연도 선택 모달, AI 피드백)
- ✅ 월간 실천계획 (3컬럼 레이아웃, AI 제안)
- ✅ 프로젝트 관리 (진행중/완료 탭, 양방향 동기화)
- ✅ 반복업무 관리 (반복 주기 설정, 오늘 할일 일괄 등록)

### 리뷰 (See)
- ✅ 주간 리포트 (통계 지표, 주간 분석, AI 주간 성찰)
- ✅ 월간 리포트 (통계 지표, 월간 분석, AI 월간 성찰)
- ✅ 연간 리포트 (통계 지표, 연간 분석, AI 연간 성찰)

### 관리자 기능
- ✅ 사용자 승인/거절/차단
- ✅ 사용 기한 설정 (개별/일괄)
- ✅ 챌린지 참가자 관리
- ✅ 관리자 통계 조회 RLS 정책

### 디자인 시스템
- ✅ Plan-Do-See 네비게이션 구조
- ✅ 카테고리 색상 시스템
- ✅ 프리미엄 색상 팔레트 업데이트
- ✅ 레이어드 섀도우 시스템
- ✅ 토글 기능 (모든 섹션)
- ✅ 모바일 레이아웃 최적화

### 배포
- ✅ GitHub 저장소 (`led-with-ai`)
- ✅ Vercel 자동 배포 파이프라인
- ✅ 관리자 페이지 배포 설정

---

## v1.0 (2025-01-15) ✅
**초기 버전 릴리즈**

### 기본 기능
- ✅ 구글 로그인 (Supabase Auth)
- ✅ 오늘 할일 (기본 CRUD)
- ✅ 오늘 루틴 (기본 체크 기능)
- ✅ 주간 리포트 (기본 통계)
- ✅ 관리자 승인 시스템

---

## v1.3 (개발 예정)
**다음 버전 계획**

### 예정 기능
- [ ] TBD (사용자 피드백 기반 우선순위 결정)


